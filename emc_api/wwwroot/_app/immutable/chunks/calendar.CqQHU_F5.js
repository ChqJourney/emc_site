var Ee=Object.defineProperty;var Ie=(r,e,t)=>e in r?Ee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var C=(r,e,t)=>Ie(r,typeof e!="symbol"?e+"":e,t);import{R as de,j as ge,l as M,m as De,T as Ae,V as T,k as A,W as pe,u as I,s as L,X,Y as ae,Z as ne,_ as se,r as x,p as O,$ as Se,x as Te,q as P,a0 as xe,a1 as ke,i as Ce,a2 as ye,H as Re,n as ie,t as V,a3 as Oe,a4 as H,e as oe,a5 as U,a6 as Z,a7 as He,a8 as Le,a9 as $e,aa as Ye,ab as Ge,ac as we,ad as Pe,ae as Ve,af as qe,ag as Fe,ah as Be,h as fe,ai as We,aj as Xe}from"./utils.sQOqgOVm.js";import{w as z,g as q}from"./index.dAKAKWrd.js";const F=0,R=1,B=2;function rt(r,e,t,a,n){M&&De();var s=r,l=de(),_=Te,h,c,u,y,o=(l?L:X)(void 0),g=(l?L:X)(void 0),i=!1;function w(d,D){i=!0,D&&(ae(p),ne(p),se(_)),d===F&&t&&(c?x(c):c=A(()=>t(s))),d===R&&a&&(u?x(u):u=A(()=>a(s,o))),d===B&&n&&(y?x(y):y=A(()=>n(s,g))),d!==F&&c&&O(c,()=>c=null),d!==R&&u&&O(u,()=>u=null),d!==B&&y&&O(y,()=>y=null),D&&(se(null),ne(null),ae(null),Se())}var p=ge(()=>{if(h!==(h=e())){if(Ae(h)){var d=h;i=!1,d.then(D=>{d===h&&(T(o,D),w(R,!0))},D=>{if(d===h&&(T(g,D),w(B,!0),!n))throw g.v}),M?t&&(c=A(()=>t(s))):pe(()=>{i||w(F,!0)})}else T(o,h),w(R,!1);return()=>h=null}});M&&(s=I)}let W=null;function at(r,e){return e}function ze(r,e,t,a){for(var n=[],s=e.length,l=0;l<s;l++)Le(e[l].e,n,!0);var _=s>0&&n.length===0&&t!==null;if(_){var h=t.parentNode;$e(h),h.append(t),a.clear(),N(r,e[0].prev,e[s-1].next)}Ye(n,()=>{for(var c=0;c<s;c++){var u=e[c];_||(a.delete(u.k),N(r,u.prev,u.next)),Ge(u.e,!_)}})}function nt(r,e,t,a,n,s=null){var l=r,_={flags:e,items:new Map,first:null},h=(e&we)!==0;if(h){var c=r;l=M?P(xe(c)):c.appendChild(ke())}M&&De();var u=null,y=!1;ge(()=>{var o=t(),g=Ce(o)?o:o==null?[]:ye(o),i=g.length;if(y&&i===0)return;y=i===0;let w=!1;if(M){var p=l.data===Re;p!==(i===0)&&(l=ie(),P(l),V(!1),w=!0)}if(M){for(var d=null,D,m=0;m<i;m++){if(I.nodeType===8&&I.data===Oe){l=I,w=!0,V(!1);break}var f=g[m],v=a(f,m);D=me(I,_,d,null,f,v,m,n,e),_.items.set(v,D),d=D}i>0&&P(ie())}if(!M){var $=Pe;Ke(g,_,l,n,e,($.f&H)!==0,a)}s!==null&&(i===0?u?x(u):u=A(()=>s(l)):u!==null&&O(u,()=>{u=null})),w&&V(!0),t()}),M&&(l=I)}function Ke(r,e,t,a,n,s,l){var Q,j,ee,te;var _=(n&Ve)!==0,h=(n&(U|Z))!==0,c=r.length,u=e.items,y=e.first,o=y,g,i=null,w,p=[],d=[],D,m,f,v;if(_)for(v=0;v<c;v+=1)D=r[v],m=l(D,v),f=u.get(m),f!==void 0&&((Q=f.a)==null||Q.measure(),(w??(w=new Set)).add(f));for(v=0;v<c;v+=1){if(D=r[v],m=l(D,v),f=u.get(m),f===void 0){var $=o?o.e.nodes_start:t;i=me($,e,i,i===null?e.first:i.next,D,m,v,a,n),u.set(m,i),p=[],d=[],o=i.next;continue}if(h&&Ue(f,D,v,n),f.e.f&H&&(x(f.e),_&&((j=f.a)==null||j.unfix(),(w??(w=new Set)).delete(f))),f!==o){if(g!==void 0&&g.has(f)){if(p.length<d.length){var k=d[0],b;i=k.prev;var J=p[0],Y=p[p.length-1];for(b=0;b<p.length;b+=1)le(p[b],k,t);for(b=0;b<d.length;b+=1)g.delete(d[b]);N(e,J.prev,Y.next),N(e,i,J),N(e,Y,k),o=k,i=Y,v-=1,p=[],d=[]}else g.delete(f),le(f,o,t),N(e,f.prev,f.next),N(e,f,i===null?e.first:i.next),N(e,i,f),i=f;continue}for(p=[],d=[];o!==null&&o.k!==m;)(s||!(o.e.f&H))&&(g??(g=new Set)).add(o),d.push(o),o=o.next;if(o===null)continue;f=o}p.push(f),i=f,o=f.next}if(o!==null||g!==void 0){for(var S=g===void 0?[]:ye(g);o!==null;)(s||!(o.e.f&H))&&S.push(o),o=o.next;var G=S.length;if(G>0){var Ne=n&we&&c===0?t:null;if(_){for(v=0;v<G;v+=1)(ee=S[v].a)==null||ee.measure();for(v=0;v<G;v+=1)(te=S[v].a)==null||te.fix()}ze(e,S,Ne,u)}}_&&pe(()=>{var re;if(w!==void 0)for(f of w)(re=f.a)==null||re.apply()}),oe.first=e.first&&e.first.e,oe.last=i&&i.e}function Ue(r,e,t,a){a&U&&T(r.v,e),a&Z?T(r.i,t):r.i=t}function me(r,e,t,a,n,s,l,_,h){var c=W;try{var u=(h&U)!==0,y=(h&He)===0,o=u?y?X(n):L(n):n,g=h&Z?L(l):l,i={i:g,v:o,k:s,a:null,e:null,prev:t,next:a};return W=i,i.e=A(()=>_(r,o,g),M),i.e.prev=t&&t.e,i.e.next=a&&a.e,t===null?e.first=i:(t.next=i,t.e.next=i.e),a!==null&&(a.prev=i,a.e.prev=i.e),i}finally{W=c}}function le(r,e,t){for(var a=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==a;){var l=qe(s);n.before(s),s=l}}function N(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}let ue=!1;function Me(){ue||(ue=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function st(r){if(M){var e=!1,t=()=>{if(!e){if(e=!0,r.hasAttribute("value")){var a=r.value;ce(r,"value",null),r.value=a}if(r.hasAttribute("checked")){var n=r.checked;ce(r,"checked",null),r.checked=n}}};r.__on_r=t,Fe(t),Me()}}function ce(r,e,t,a){var n=r.__attributes??(r.__attributes={});M&&(n[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||n[e]!==(n[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Be]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Ze(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var ve=new Map;function Ze(r){var e=ve.get(r.nodeName);if(e)return e;ve.set(r.nodeName,e=[]);for(var t,a=fe(r),n=Element.prototype;n!==a;){t=We(a);for(var s in t)t[s].set&&e.push(s);a=fe(a)}return e}function Je(r,e,t,a=t){r.addEventListener(e,t);const n=r.__on_r;n?r.__on_r=()=>{n(),a()}:r.__on_r=a,Me()}function it(r,e,t=e){var a=de();Je(r,"input",()=>{var n=_e(r)?he(r.value):r.value;t(n),a&&n!==(n=e())&&(r.value=n??"")}),Xe(()=>{var n=e();if(M&&r.defaultValue!==r.value){t(r.value);return}_e(r)&&n===he(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function _e(r){var e=r.type;return e==="number"||e==="range"}function he(r){return r===""?null:+r}const be=z({});function ot(r,e){be.update(t=>({...t,[r]:e}))}function Qe(r){let e;return be.subscribe(t=>{e=t[r]}),e}const E=class E{constructor(){C(this,"currentMonth");C(this,"selectedDate");const e=new Date().toISOString().split("T")[0];this.currentMonth=z(new Date().toISOString().split("-").slice(0,2).join("-")),this.selectedDate=z(e)}static getInstance(){return E.instance||(E.instance=new E),E.instance}changeMonth(e){const[t,a]=q(this.currentMonth).split("-").map(Number),n=new Date(t,a-1+e,1),s=`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}`;this.currentMonth.set(s),this.selectedDate.set(`${s}-01`)}getDaysInMonth(e){const[t,a]=e.split("-").map(Number);return new Date(t,a,0).getDate()}getFirstDayOfMonth(e){const[t,a]=e.split("-").map(Number);return new Date(t,a-1,1).getDay()}getCalendarDays(e){const t=this.getDaysInMonth(e);return Array.from({length:t},(a,n)=>n+1)}getDayReservations(e,t){return(t==null?void 0:t.filter(a=>a.reservation_date===e))??[]}getDayColor(e,t){const a=this.getDayReservations(e,t).length,n=Qe("loadSetting");return a===0?"transparent":a<=n.low_load?`rgba(75, 192, 92, 0.${a*2})`:a<=n.medium_load?`rgba(255, 205, 86, 0.${a*2})`:a<=n.high_load?`rgba(255, 153, 0, 0.${a*2})`:"rgba(255, 99, 132, 0.8)"}getDayReservationCount(e,t){return this.getDayReservations(e,t).length}formatDate(e,t){return`${e}-${t.toString().padStart(2,"0")}`}getMonthDisplay(e){const[t,a]=e.split("-").map(Number);return new Date(t,a-1).toLocaleString("zh-CN",{year:"numeric",month:"long"})}setDate(e){this.selectedDate.set(e);const t=e.substring(0,7);t!==q(this.currentMonth)&&this.currentMonth.set(t)}change(e){const t=new Date(q(this.selectedDate));t.setDate(t.getDate()+e);const a=t.toISOString().split("T")[0];this.setDate(a)}previous(){this.change(-1)}next(){this.change(1)}getPreviousMonthDays(e){const[t,a]=e.split("-").map(Number),n=new Date(t,a-1,1).getDay();if(n===0)return[];const s=a-1,l=s===0?t-1:t,_=new Date(l,s===0?12:s,0).getDate(),h=[];for(let c=_-n+1;c<=_;c++)h.push(c);return h}isToday(e){const t=new Date,[a,n,s]=e.split("-").map(Number);return t.getFullYear()===a&&t.getMonth()+1===n&&t.getDate()===s}getNextMonthDays(e){const[t,a]=e.split("-").map(Number),n=new Date(t,a,0).getDate(),s=new Date(t,a-1,n).getDay();if(s===6)return[];const l=[];for(let _=1;_<=6-s;_++)l.push(_);return l}};C(E,"instance");let K=E;const ft=K.getInstance();export{rt as a,it as b,ft as c,ce as d,nt as e,Qe as g,at as i,st as r,ot as s};
