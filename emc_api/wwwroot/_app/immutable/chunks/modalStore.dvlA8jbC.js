var T=Object.defineProperty;var u=(s,e,t)=>e in s?T(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var l=(s,e,t)=>u(s,typeof e!="symbol"?e+"":e,t);import{l as N}from"./utils.Dv3gV-s9.js";import{w as i}from"./index.DD94zoj9.js";function w(s,e){var t=s.__className,a=D(e);N&&s.className===a?s.__className=a:(t!==a||N&&s.className!==a)&&(e==null?s.removeAttribute("class"):s.className=a,s.__className=a)}function D(s){return s??""}function L(s,e,t){if(t){if(s.classList.contains(e))return;s.classList.add(e)}else{if(!s.classList.contains(e))return;s.classList.remove(e)}}var R=(s=>(s[s.DB_CONNECTION_ERROR=1e3]="DB_CONNECTION_ERROR",s[s.DB_QUERY_ERROR=1001]="DB_QUERY_ERROR",s[s.DB_TRANSACTION_ERROR=1002]="DB_TRANSACTION_ERROR",s[s.RESERVATION_CONFLICT=2e3]="RESERVATION_CONFLICT",s[s.STATION_NOT_AVAILABLE=2001]="STATION_NOT_AVAILABLE",s[s.INVALID_TIME_SLOT=2002]="INVALID_TIME_SLOT",s[s.UNAUTHORIZED_ACCESS=2003]="UNAUTHORIZED_ACCESS",s[s.INVALID_INPUT=3e3]="INVALID_INPUT",s[s.REQUIRED_FIELD_MISSING=3001]="REQUIRED_FIELD_MISSING",s[s.INVALID_DATE_FORMAT=3002]="INVALID_DATE_FORMAT",s[s.INVALID_PHONE_FORMAT=3003]="INVALID_PHONE_FORMAT",s[s.ExportExcelFileError=4001]="ExportExcelFileError",s[s.API_ERROR=4002]="API_ERROR",s[s.API_PARSE_ERROR=4003]="API_PARSE_ERROR",s[s.API_REQUEST_ERROR=4004]="API_REQUEST_ERROR",s[s.UNKNOWN_ERROR=9999]="UNKNOWN_ERROR",s))(R||{});class c extends Error{constructor(e,t,a){super(t),this.code=e,this.message=t,this.details=a,this.name="AppError"}}const A={1e3:"数据库连接失败",1001:"数据库查询错误",1002:"数据库事务错误",2e3:"该时间段已被预约",2001:"工位不可用",2002:"无效的时间段",2003:"未授权的访问",3e3:"输入数据无效",3001:"必填字段缺失",3002:"日期格式无效",3003:"电话号码格式无效",4001:"导出Excel文件时发生错误",9999:"未知错误"},_=i({show:!1,message:"",type:"error"}),n=class n{constructor(){}static getInstance(){return n.instance||(n.instance=new n),n.instance}handleError(e){if(console.error("Error occurred:",e),e instanceof c)switch(this.showError(`${e.message}${e.details?":":""} ${e.details??""}`||A[e.code]),e.code){case R.DB_CONNECTION_ERROR:break;case R.UNAUTHORIZED_ACCESS:break}else this.showError(e.message||A[R.UNKNOWN_ERROR])}showError(e){_.set({show:!0,message:e,type:"error"}),setTimeout(()=>{_.set({show:!1,message:"",type:"error"})},5e3)}showWarning(e){_.set({show:!0,message:e,type:"warning"}),setTimeout(()=>{_.set({show:!1,message:"",type:"error"})},3e3)}showInfo(e){_.set({show:!0,message:e,type:"info"}),setTimeout(()=>{_.set({show:!1,message:"",type:"error"})},3e3)}validatePhone(e){if(!/^1[3-9]\d{9}$/.test(e))throw new c(R.INVALID_PHONE_FORMAT,"请输入有效的手机号码");return!0}validateRequired(e,t){if(e==null||e==="")throw new c(R.REQUIRED_FIELD_MISSING,`${t}不能为空`);return!0}validateDate(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))throw new c(R.INVALID_DATE_FORMAT,"日期格式无效，请使用YYYY-MM-DD格式");return!0}};l(n,"instance");let I=n;const g=I.getInstance(),O=i({});function o(s,e){O.update(t=>({...t,[s]:e}))}function U(s){let e;return O.subscribe(t=>{e=t[s]}),e}function h(){const{subscribe:s,set:e,update:t}=i({show:!1,component:null,props:{}});return{subscribe:s,open:(a,E={})=>{e({show:!0,component:a,props:E})},close:()=>{e({show:!1,component:null,props:{}})}}}const m=h();export{c as A,R as E,o as a,_ as b,g as e,U as g,m,w as s,L as t};
