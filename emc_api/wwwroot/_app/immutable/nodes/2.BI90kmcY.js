import{d as X,s as ss,b as u,a as r,t as n,c as es,e as ds}from"../chunks/disclose-version.CoNHZQ4F.js";import{I as ts,M as e,O as l,K as f,N as t,P as gs,L as as,J as q,d as a,C as x}from"../chunks/utils.sQOqgOVm.js";import{c as o,g as ps,a as Q,r as hs,e as Y,b as _s,s as M,i as Z,d as U}from"../chunks/calendar.CqQHU_F5.js";import{m as H,a as W,e as us,s as fs}from"../chunks/modalStore.CRgIuiNX.js";import{g as ks}from"../chunks/entry.DA97GV68.js";import{o as ys}from"../chunks/index-client.DKsD9lEg.js";import{i as ms}from"../chunks/lifecycle.ah3VV2aB.js";var ws=n('<div class="about-container svelte-1s727u1"><button class="close-button svelte-1s727u1">关闭</button> <h3 class="svelte-1s727u1">关于 EMC 预约系统</h3> <div class="content svelte-1s727u1"><p class="version svelte-1s727u1">版本：Client v20250228</p> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">系统说明</h4> <p class="svelte-1s727u1">EMC 预约系统是专门为 Intertek Zhejiang EMC实验室开发的预约管理系统。本系统用于查看和管理预约信息。</p></div> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">功能特点</h4> <div class="features svelte-1s727u1"><ul class="svelte-1s727u1"><li class="svelte-1s727u1">高度可视化界面</li> <li class="svelte-1s727u1">支持按工位查看预约</li> <li class="svelte-1s727u1">支持按日期查看预约</li> <li class="svelte-1s727u1">预约信息详情展示</li> <li class="svelte-1s727u1">支持数据源快速更换</li> <li style="color: orange;" class="svelte-1s727u1">支持预约创建、修改、删除</li> <li style="color: orange;" class="svelte-1s727u1">支持多时段预约创建</li> <li style="color: orange;" class="svelte-1s727u1">支持工位创建、修改、删除</li> <li style="color: orange;" class="svelte-1s727u1">支持工位复制式创建</li> <li style="color: orange;" class="svelte-1s727u1">支持工位拖曳排序</li> <li style="color: orange;" class="svelte-1s727u1">支持测试内容自定义</li> <li style="color: orange;" class="svelte-1s727u1">支持人员自定义</li> <li style="color: orange;" class="svelte-1s727u1">支持访问记录查询</li> <li style="color: orange;" class="svelte-1s727u1">支持测试工位智能适配</li> <li style="color: orange;" class="svelte-1s727u1">支持数据导出</li> <li style="color: orange;" class="svelte-1s727u1">支持数据图谱展示（待开发）</li></ul> <div style="padding-left: 3rem;"><span style="width: 10px; height: 10px; display: inline-block; background-color: orange;"></span> <div style="display: inline-block; color: orange;">仅管理员端和工程师端含此功能</div></div></div></div> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">技术支持</h4> <p class="svelte-1s727u1">如有任何问题或建议，请联系系统管理员Leo Ye/Patrick Chen。</p></div></div> <footer class="copyright svelte-1s727u1"><p style="display: flex; align-items: center; justify-content: center;" class="svelte-1s727u1"><svg style="margin-right: 5px; width: 12px;height:12px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M596.1 423c-6.9-45.6-35-69.3-84.4-71h-1.8c-52.3 3.8-80.1 58.1-83.3 163.1v1c3.3 103.4 31.1 156.9 83.4 160.7h1.7c50.7-1.7 79-25.2 84.7-70.6 1-7.7 7.5-13.6 15.3-13.6h70.1c9.2 0 16.4 8.1 15.3 17.3-11.1 86.5-73.2 130.4-186.2 132-120.2-3.2-182-78.4-185.3-225.7v-1c4.9-150.3 66.5-227.9 184.8-232.9h1c111.4 1.7 173.2 47.2 185.5 136.6 1.3 9.2-5.9 17.4-15.3 17.4h-70.2c-7.7-0.1-14.2-5.7-15.3-13.3z"></path><path d="M512 65c60.4 0 118.9 11.8 174 35.1 53.2 22.5 101 54.7 142.1 95.8 41.1 41.1 73.3 88.9 95.8 142.1 23.3 55.1 35.1 113.6 35.1 174 0 60.4-11.8 118.9-35.1 174-22.5 53.2-54.7 101-95.8 142.1-41.1 41.1-88.9 73.3-142.1 95.8-55.1 23.3-113.6 35.1-174 35.1-60.4 0-118.9-11.8-174-35.1-53.2-22.5-101-54.7-142.1-95.8s-73.3-88.9-95.8-142.1C76.8 630.9 65 572.4 65 512c0-60.4 11.8-118.9 35.1-174 22.5-53.2 54.7-101 95.8-142.1 41.1-41.1 88.9-73.3 142.1-95.8C393.1 76.8 451.6 65 512 65m0-65C229.2 0 0 229.2 0 512s229.2 512 512 512 512-229.2 512-512S794.8 0 512 0z"></path></svg> </p> <p class="rights svelte-1s727u1">All Rights Reserved</p></footer></div>');function bs(k,d){ts(d,!1);const $=ss(),i=()=>es(H,"$modalStore",$);let{onNegative:I}=i().props;ms();var y=ws(),C=e(y);C.__click=I;var j=l(C,6),A=e(j),G=l(e(A));f(()=>u(G,` ${new Date().getFullYear()??""} Intertek Zhejiang EMC Department`)),t(A),gs(2),t(j),t(y),r(k,y),as()}X(["click"]);var xs=(k,d)=>d(new Date().toISOString().split("T")[0]),Ms=()=>o.changeMonth(-1),$s=(k,d)=>d(),Cs=()=>o.changeMonth(1),Ds=()=>H.open(bs,{onNegative:()=>H.close()}),Ss=n('<div class="day empty other-month svelte-1kc9sfv"> </div>'),zs=(k,d,$)=>d(a($)),Ls=n('<div><div class="tooltip svelte-1kc9sfv"> </div> </div>'),Es=n('<div class="day empty other-month svelte-1kc9sfv"> </div>'),Is=n('<img src="intertek.png" alt="bg" class="svelte-1kc9sfv"> <div class="calendar svelte-1kc9sfv"><div class="weekdays svelte-1kc9sfv"><div style="text-align: center;" class="svelte-1kc9sfv">日</div> <div style="text-align: center;" class="svelte-1kc9sfv">一</div> <div style="text-align: center;" class="svelte-1kc9sfv">二</div> <div style="text-align: center;" class="svelte-1kc9sfv">三</div> <div style="text-align: center;" class="svelte-1kc9sfv">四</div> <div style="text-align: center;" class="svelte-1kc9sfv">五</div> <div style="text-align: center;" class="svelte-1kc9sfv">六</div></div> <div class="days svelte-1kc9sfv"><!> <!> <!></div></div>',1),js=()=>window.location.reload(),As=n('<div class="error-container svelte-1kc9sfv"><div class="error-icon svelte-1kc9sfv">❌</div> <div class="error-content svelte-1kc9sfv"><h3 class="error-title svelte-1kc9sfv">抱歉，出现了问题</h3> <p class="error-message svelte-1kc9sfv"> </p></div> <button class="retry-button svelte-1kc9sfv">重新加载</button></div>'),Bs=n('<div class="loading-container svelte-1kc9sfv"><div class="loading-spinner svelte-1kc9sfv"></div> <span class="loading-text svelte-1kc9sfv">加载中...</span></div>'),Ns=n('<div class="fixed-header svelte-1kc9sfv"><button aria-label="today" class="tooltip-container svelte-1kc9sfv"><span class="tooltip svelte-1kc9sfv">返回今天</span> <svg class="logo svelte-1kc9sfv" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M810.653961 127.994116l-42.664705 0L767.989255 42.664705l-85.329411 0 0 85.329411L341.340155 127.994116 341.340155 42.664705l-85.329411 0 0 85.329411-42.664705 0c-47.14474 0-84.902692 38.184671-84.902692 85.329411l-0.426719 597.307921c0 47.14474 38.184671 85.329411 85.329411 85.329411l597.307921 0c47.14474 0 85.329411-38.184671 85.329411-85.329411L895.983371 213.32455C895.983371 166.17981 857.7987 127.994116 810.653961 127.994116zM810.653961 810.632471 213.346039 810.632471 213.346039 341.318666l597.307921 0L810.653961 810.632471zM298.67545 426.6491l213.32455 0 0 213.32455L298.67545 639.97365 298.67545 426.6491z" class="svelte-1kc9sfv"></path></svg></button> <div class="month-nav svelte-1kc9sfv"><button class="tooltip-container svelte-1kc9sfv" aria-label="previous_month"><span class="tooltip svelte-1kc9sfv">上个月</span> <svg class="logo svelte-1kc9sfv" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M629.291 840.832l60.331-60.331-268.501-268.501 268.501-268.501-60.331-60.331-328.832 328.832z" class="svelte-1kc9sfv"></path></svg></button> <input type="month" class="month-input svelte-1kc9sfv"> <button class="tooltip-container svelte-1kc9sfv" aria-label="next_month"><span class="tooltip svelte-1kc9sfv">下个月</span> <svg class="logo svelte-1kc9sfv" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M689.621 512l-328.832-328.832-60.331 60.331 268.501 268.501-268.501 268.501 60.331 60.331z" class="svelte-1kc9sfv"></path></svg></button></div> <button class="tooltip-container svelte-1kc9sfv" aria-label="about"><span class="tooltip svelte-1kc9sfv">关于</span> <svg class="logo svelte-1kc9sfv" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M512 32C247.04 32 32 247.04 32 512s215.04 480 480 480 480-215.04 480-480S776.96 32 512 32z m58.56 725.76c0 25.92-21.12 47.04-47.04 47.04h-23.52c-25.92 0-47.04-21.12-47.04-47.04V476.96c0-25.92 21.12-47.04 47.04-47.04h23.52c25.92 0 47.04 21.12 47.04 47.04v280.8zM512 359.84c-32.16 0-58.56-26.4-58.56-58.56 0-32.16 26.4-58.56 58.56-58.56s58.56 26.4 58.56 58.56c0 32.16-26.4 58.56-58.56 58.56z" class="svelte-1kc9sfv"></path></svg></button></div> <div class="calendar-container svelte-1kc9sfv"><!></div>',1),Os=()=>window.location.reload(),Ps=n('<div class="error-container svelte-1kc9sfv"><div class="error-icon svelte-1kc9sfv">❌</div> <div class="error-content svelte-1kc9sfv"><h3 class="error-title svelte-1kc9sfv">抱歉，出现了问题</h3> <p class="error-message svelte-1kc9sfv"> </p></div> <button class="retry-button svelte-1kc9sfv">重新加载</button></div>'),Gs=n('<div class="loading-container svelte-1kc9sfv"><div class="loading-spinner svelte-1kc9sfv"></div> <span class="loading-text svelte-1kc9sfv">加载中...</span></div>'),Rs=n('<div class="page-container svelte-1kc9sfv"><!></div>');function Vs(k,d){ts(d,!0);const $=ss(),i=()=>es(I,"$currentMonth",$),I=o.currentMonth;ps("run_mode");async function y(){try{const s=parseInt(i().split("-")[0]),g=parseInt(i().split("-")[1]),h=new Date(s,g,0).getDate();return await W.get(`/reservations/month/${i()}`)}catch(s){return us.handleError(s),[]}}function C(s){console.log(s),ks(`/date?date=${s}`)}const j=x(()=>o.getFirstDayOfMonth(i())),A=x(()=>o.getCalendarDays(i())),G=async()=>{const s=await W.get("/general/settings");M("tests",s.tests),M("project_engineers",s.project_engineers),M("testing_engineers",s.testing_engineers),M("loadSetting",s.loadSetting),M("station_orders",s.station_orders),M("user",{user:"page",machine:""}),await new Promise(g=>setTimeout(g,200))},J=s=>{s.key==="ArrowLeft"?o.changeMonth(-1):s.key==="ArrowRight"&&o.changeMonth(1)};ys(()=>(window.addEventListener("keydown",J),()=>{window.removeEventListener("keydown",J)}));var R=Rs(),ls=e(R);Q(ls,G,s=>{var g=Gs();r(s,g)},(s,g)=>{var h=Ns(),p=q(h),D=e(p);D.__click=[xs,C];var S=l(D,2),B=e(S);B.__click=[Ms];var N=l(B,2);hs(N),N.__change=[$s,y];var vs=l(N,2);vs.__click=[Cs],t(S);var os=l(S,2);os.__click=[Ds],t(p);var V=l(p,2),is=e(V);Q(is,y,_=>{var m=Bs();r(_,m)},(_,m)=>{var w=Is(),b=l(q(w),2),z=l(e(b),2),O=e(z);Y(O,17,()=>Array(a(j)),Z,(L,E,v)=>{var c=Ss();const T=x(()=>o.getPreviousMonthDays(i())[v]);var F=e(c,!0);t(c),f(()=>u(F,a(T))),r(L,c)});var P=l(O,2);Y(P,17,()=>a(A),Z,(L,E)=>{var v=Ls();const c=x(()=>`${i()}-${a(E).toString().padStart(2,"0")}`),T=x(()=>`tooltip-container day ${(o.isToday(a(c))?"today":"")??""} svelte-1kc9sfv`),F=x(()=>`background-color: ${o.getDayColor(a(c),a(m))??""}`);v.__click=[zs,C,c];var K=e(v),rs=e(K,!0);f(()=>u(rs,`${o.getDayReservationCount(a(c),a(m))}个预约`)),t(K);var ns=l(K);t(v),f(()=>{fs(v,a(T)),U(v,"title",`Go to ${a(c)}`),U(v,"style",a(F)),u(ns,` ${a(E)??""}`)}),r(L,v)});var cs=l(P,2);Y(cs,1,()=>o.getNextMonthDays(i()),Z,(L,E)=>{var v=Es(),c=e(v,!0);t(v),f(()=>u(c,a(E))),r(L,v)}),t(z),t(b),r(_,w)},(_,m)=>{var w=As(),b=l(e(w),2),z=l(e(b),2),O=e(z,!0);t(z),t(b);var P=l(b,2);P.__click=[js],t(w),f(()=>u(O,a(m).message)),r(_,w)}),t(V),_s(N,i,_=>ds(I,_)),r(s,h)},(s,g)=>{var h=Ps(),p=l(e(h),2),D=l(e(p),2),S=e(D,!0);t(D),t(p);var B=l(p,2);B.__click=[Os],t(h),f(()=>u(S,a(g).message+" "+a(g).details)),r(s,h)}),t(R),r(k,R),as()}X(["click","change"]);export{Vs as component};
