import{d as ee,s as se,b as x,a as v,t as c,c as te,e as ue}from"../chunks/disclose-version.BtOGdF5q.js";import{I as ae,M as t,O as i,K as y,N as a,P as pe,L as le,J as Q,d as s,C as _}from"../chunks/utils.Dv3gV-s9.js";import{c as n,a as U,r as he,e as P,b as me,d as _e,i as xe,f as R,s as W}from"../chunks/operation.Bbmgri_J.js";import{m as G,g as C,e as ye,a as D,s as we}from"../chunks/modalStore.dvlA8jbC.js";import{g as fe}from"../chunks/entry.CoaMbvJu.js";import{o as be}from"../chunks/index-client.MCpA-LfM.js";import{i as Me}from"../chunks/lifecycle.CkqpZYRK.js";import{a as X}from"../chunks/apiService.DgwLLXM9.js";var ke=c('<div class="about-container svelte-1s727u1"><button class="close-button svelte-1s727u1">关闭</button> <h3 class="svelte-1s727u1">关于 EMC 预约系统</h3> <div class="content svelte-1s727u1"><p class="version svelte-1s727u1">版本：Client v20250122</p> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">系统说明</h4> <p class="svelte-1s727u1">EMC 预约系统是专门为 Intertek Zhejiang EMC实验室开发的预约管理系统。本系统用于查看和管理预约信息。</p></div> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">功能特点</h4> <div class="features svelte-1s727u1"><ul class="svelte-1s727u1"><li class="svelte-1s727u1">高度可视化界面</li> <li class="svelte-1s727u1">支持按工位查看预约</li> <li class="svelte-1s727u1">支持按日期查看预约</li> <li class="svelte-1s727u1">预约信息详情展示</li> <li class="svelte-1s727u1">支持数据源快速更换</li> <li style="color: orange;" class="svelte-1s727u1">支持预约创建、修改、删除</li> <li style="color: orange;" class="svelte-1s727u1">支持多时段预约创建</li> <li style="color: orange;" class="svelte-1s727u1">支持工位创建、修改、删除</li> <li style="color: orange;" class="svelte-1s727u1">支持工位复制式创建</li> <li style="color: orange;" class="svelte-1s727u1">支持工位拖曳排序</li> <li style="color: orange;" class="svelte-1s727u1">支持测试内容自定义</li> <li style="color: orange;" class="svelte-1s727u1">支持人员自定义</li> <li style="color: orange;" class="svelte-1s727u1">支持访问记录查询</li> <li style="color: orange;" class="svelte-1s727u1">支持测试工位智能适配</li> <li style="color: orange;" class="svelte-1s727u1">支持数据导出</li> <li style="color: orange;" class="svelte-1s727u1">支持数据图谱展示（待开发）</li></ul> <div style="padding-left: 3rem;"><span style="width: 10px; height: 10px; display: inline-block; background-color: orange;"></span> <div style="display: inline-block; color: orange;">仅管理员端和工程师端含此功能</div></div></div></div> <div class="section svelte-1s727u1"><h4 class="svelte-1s727u1">技术支持</h4> <p class="svelte-1s727u1">如有任何问题或建议，请联系系统管理员Leo Ye/Patrick Chen。</p></div></div> <footer class="copyright svelte-1s727u1"><p style="display: flex; align-items: center; justify-content: center;" class="svelte-1s727u1"><svg style="margin-right: 5px; width: 12px;height:12px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M596.1 423c-6.9-45.6-35-69.3-84.4-71h-1.8c-52.3 3.8-80.1 58.1-83.3 163.1v1c3.3 103.4 31.1 156.9 83.4 160.7h1.7c50.7-1.7 79-25.2 84.7-70.6 1-7.7 7.5-13.6 15.3-13.6h70.1c9.2 0 16.4 8.1 15.3 17.3-11.1 86.5-73.2 130.4-186.2 132-120.2-3.2-182-78.4-185.3-225.7v-1c4.9-150.3 66.5-227.9 184.8-232.9h1c111.4 1.7 173.2 47.2 185.5 136.6 1.3 9.2-5.9 17.4-15.3 17.4h-70.2c-7.7-0.1-14.2-5.7-15.3-13.3z"></path><path d="M512 65c60.4 0 118.9 11.8 174 35.1 53.2 22.5 101 54.7 142.1 95.8 41.1 41.1 73.3 88.9 95.8 142.1 23.3 55.1 35.1 113.6 35.1 174 0 60.4-11.8 118.9-35.1 174-22.5 53.2-54.7 101-95.8 142.1-41.1 41.1-88.9 73.3-142.1 95.8-55.1 23.3-113.6 35.1-174 35.1-60.4 0-118.9-11.8-174-35.1-53.2-22.5-101-54.7-142.1-95.8s-73.3-88.9-95.8-142.1C76.8 630.9 65 572.4 65 512c0-60.4 11.8-118.9 35.1-174 22.5-53.2 54.7-101 95.8-142.1 41.1-41.1 88.9-73.3 142.1-95.8C393.1 76.8 451.6 65 512 65m0-65C229.2 0 0 229.2 0 512s229.2 512 512 512 512-229.2 512-512S794.8 0 512 0z"></path></svg> </p> <p class="rights svelte-1s727u1">All Rights Reserved</p></footer></div>');function $e(h,g){ae(g,!1);const w=se(),o=()=>te(G,"$modalStore",w);let{onNegative:S}=o().props;Me();var m=ke(),f=t(m);f.__click=S;var b=i(f,6),z=t(b),j=i(t(z));y(()=>x(j,` ${new Date().getFullYear()??""} Intertek Zhejiang EMC Department`)),a(z),pe(2),a(b),a(m),v(h,m),le()}ee(["click"]);var Ce=(h,g)=>g(new Date().toISOString().split("T")[0]),De=()=>n.changeMonth(-1),Se=(h,g)=>g(),ze=()=>n.changeMonth(1),Le=()=>G.open($e,{onNegative:()=>G.close()}),Ee=c('<div class="day empty other-month svelte-1oxm8ug"> </div>'),je=(h,g,w)=>g(s(w)),Ie=c('<div><div class="tooltip svelte-1oxm8ug"> </div> </div>'),Be=c('<div class="day empty other-month svelte-1oxm8ug"> </div>'),Ae=c('<img src="intertek.png" alt="bg" class="svelte-1oxm8ug"> <div class="calendar svelte-1oxm8ug"><div class="weekdays svelte-1oxm8ug"><div style="text-align: center;" class="svelte-1oxm8ug">日</div> <div style="text-align: center;" class="svelte-1oxm8ug">一</div> <div style="text-align: center;" class="svelte-1oxm8ug">二</div> <div style="text-align: center;" class="svelte-1oxm8ug">三</div> <div style="text-align: center;" class="svelte-1oxm8ug">四</div> <div style="text-align: center;" class="svelte-1oxm8ug">五</div> <div style="text-align: center;" class="svelte-1oxm8ug">六</div></div> <div class="days svelte-1oxm8ug"><!> <!> <!></div></div>',1),Ne=c('<div class="loading-container svelte-1oxm8ug"><div class="loading-spinner svelte-1oxm8ug"></div> <span class="loading-text svelte-1oxm8ug">加载中...</span></div>'),Oe=c('<div class="fixed-header svelte-1oxm8ug"><button aria-label="today" class="tooltip-container svelte-1oxm8ug"><span class="tooltip svelte-1oxm8ug">返回今天</span> <svg class="logo svelte-1oxm8ug" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M810.653961 127.994116l-42.664705 0L767.989255 42.664705l-85.329411 0 0 85.329411L341.340155 127.994116 341.340155 42.664705l-85.329411 0 0 85.329411-42.664705 0c-47.14474 0-84.902692 38.184671-84.902692 85.329411l-0.426719 597.307921c0 47.14474 38.184671 85.329411 85.329411 85.329411l597.307921 0c47.14474 0 85.329411-38.184671 85.329411-85.329411L895.983371 213.32455C895.983371 166.17981 857.7987 127.994116 810.653961 127.994116zM810.653961 810.632471 213.346039 810.632471 213.346039 341.318666l597.307921 0L810.653961 810.632471zM298.67545 426.6491l213.32455 0 0 213.32455L298.67545 639.97365 298.67545 426.6491z" class="svelte-1oxm8ug"></path></svg></button> <div class="month-nav svelte-1oxm8ug"><button class="tooltip-container svelte-1oxm8ug" aria-label="previous_month"><span class="tooltip svelte-1oxm8ug">上个月</span> <svg class="logo svelte-1oxm8ug" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M629.291 840.832l60.331-60.331-268.501-268.501 268.501-268.501-60.331-60.331-328.832 328.832z" class="svelte-1oxm8ug"></path></svg></button> <input type="month" class="month-input svelte-1oxm8ug"> <button class="tooltip-container svelte-1oxm8ug" aria-label="next_month"><span class="tooltip svelte-1oxm8ug">下个月</span> <svg class="logo svelte-1oxm8ug" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M689.621 512l-328.832-328.832-60.331 60.331 268.501 268.501-268.501 268.501 60.331 60.331z" class="svelte-1oxm8ug"></path></svg></button></div> <button class="tooltip-container svelte-1oxm8ug" aria-label="about"><span class="tooltip svelte-1oxm8ug">关于</span> <svg class="logo svelte-1oxm8ug" style="fill: #fbc400;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200"><path d="M512 32C247.04 32 32 247.04 32 512s215.04 480 480 480 480-215.04 480-480S776.96 32 512 32z m58.56 725.76c0 25.92-21.12 47.04-47.04 47.04h-23.52c-25.92 0-47.04-21.12-47.04-47.04V476.96c0-25.92 21.12-47.04 47.04-47.04h23.52c25.92 0 47.04 21.12 47.04 47.04v280.8zM512 359.84c-32.16 0-58.56-26.4-58.56-58.56 0-32.16 26.4-58.56 58.56-58.56s58.56 26.4 58.56 58.56c0 32.16-26.4 58.56-58.56 58.56z" class="svelte-1oxm8ug"></path></svg></button></div> <div class="calendar-container svelte-1oxm8ug"><!></div>',1),Pe=c('<div class="svelte-1oxm8ug"> </div>'),Re=c('<div class="loading-container svelte-1oxm8ug"><div class="loading-spinner svelte-1oxm8ug"></div> <span class="loading-text svelte-1oxm8ug">加载中...</span></div>'),Ge=c('<div class="page-container svelte-1oxm8ug"><!></div>');function qe(h,g){ae(g,!0);const w=se(),o=()=>te(S,"$currentMonth",w),S=n.currentMonth,m=C("run_mode");async function f(){try{const e=parseInt(o().split("-")[0]),p=parseInt(o().split("-")[1]),d=new Date(e,p,0).getDate();return m==="page"?await X.get(`/reservations/month/${o()}`):await _e.getReservationsByMonth(o())}catch(e){return ye.handleError(e),[]}}function b(e){console.log(e),fe(`/date?date=${e}`)}const z=_(()=>n.getFirstDayOfMonth(o())),j=_(()=>n.getCalendarDays(o())),oe=async()=>{if(m==="page"){console.log("page mode");const e=await X.get("/general/settings");D("tests",e.tests),D("project_engineers",e.project_engineers),D("testing_engineers",e.testing_engineers),D("loadSetting",e.loadSetting),D("station_orders",e.station_orders)}else{const e=C("user"),p=C("tests"),d=C("project_engineers"),u=C("testing_engineers");(!e||!p||!d||!u)&&await xe()}await new Promise(e=>setTimeout(e,200))},T=e=>{e.key==="ArrowLeft"?n.changeMonth(-1):e.key==="ArrowRight"&&n.changeMonth(1)};be(()=>(window.addEventListener("keydown",T),()=>{window.removeEventListener("keydown",T)}));var I=Ge(),ie=t(I);U(ie,oe,e=>{var p=Re();v(e,p)},(e,p)=>{var d=Oe(),u=Q(d),F=t(u);F.__click=[Ce,b];var B=i(F,2),K=t(B);K.__click=[De];var L=i(K,2);he(L),L.__change=[Se,f];var ne=i(L,2);ne.__click=[ze],a(B);var re=i(B,2);re.__click=[Le],a(u);var Y=i(u,2),ve=t(Y);U(ve,f,M=>{var E=Ne();v(M,E)},(M,E)=>{var Z=Ae(),H=i(Q(Z),2),J=i(t(H),2),V=t(J);P(V,17,()=>Array(s(z)),R,(k,$,l)=>{var r=Ee();const A=_(()=>n.getPreviousMonthDays(o())[l]);var N=t(r,!0);a(r),y(()=>x(N,s(A))),v(k,r)});var q=i(V,2);P(q,17,()=>s(j),R,(k,$)=>{var l=Ie();const r=_(()=>`${o()}-${s($).toString().padStart(2,"0")}`),A=_(()=>`tooltip-container day ${(n.isToday(s(r))?"today":"")??""} svelte-1oxm8ug`),N=_(()=>`background-color: ${n.getDayColor(s(r),s(E))??""}`);l.__click=[je,b,r];var O=t(l),ge=t(O,!0);y(()=>x(ge,`${n.getDayReservationCount(s(r),s(E))}个预约`)),a(O);var de=i(O);a(l),y(()=>{we(l,s(A)),W(l,"title",`Go to ${s(r)}`),W(l,"style",s(N)),x(de,` ${s($)??""}`)}),v(k,l)});var ce=i(q,2);P(ce,1,()=>n.getNextMonthDays(o()),R,(k,$)=>{var l=Be(),r=t(l,!0);a(l),y(()=>x(r,s($))),v(k,l)}),a(J),a(H),v(M,Z)}),a(Y),me(L,o,M=>ue(S,M)),v(e,d)},(e,p)=>{var d=Pe(),u=t(d,!0);a(d),y(()=>x(u,"Error: "+s(p).message)),v(e,d)}),a(I),v(h,I),le()}ee(["click","change"]);export{qe as component};
